<!DOCTYPE html>
<html lang="en">

<head>
    <title>Admin Profile | SNP</title>
    <meta name="description" content="User profile page | Simptoms" />
    <meta name="keywords" content="profile, status" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="ro" />
    <meta charset="utf-8" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="TestProfile-style.css" />
    <link rel="icon" href="../public/logo.ico" tpye="img/ico" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <style>
        .navbar { 
            width: 100% !important;
            margin-bottom: 40px;
        }
        .make-appointment {
      color: white !important;
    }

    .make-appointment:hover {
      background-color: rgb(91, 91, 195) !important;
      border-color: rgb(91, 91, 195) !important;
    }

    .btn-round-full {
      border-radius: 50px;
    }

    .btn-main {
      background: #3c5d9c;
      color: #fff;
      border-color: #3c5d9c;
      box-shadow: 0px 0px 0px 0px white !important;
    }
    </style>
</head>

<body>
    <header>
        <%- include("partials/header2.ejs") -%>
    </header>
    <div class="container" id="blur">
        <div class="main-body">
            <div class="row gutters-sm">
                <div class="col-md-4 mb-3">
                    <div class="card">
                        <div class="card-body">
                            <div class="d-flex flex-column align-items-center text-center">

                                <img src="https://bootdey.com/img/Content/avatar/avatar7.png" alt="Admin"
                                    class="rounded-circle" width="150">
                                <div class="mt-3">


                                    <h4 id="profileFullName"><%=loggedUser.firstName%> <%=loggedUser.lastName%> </h4>
                                    <p class="text-secondary mb-1" id="profileLevel"><%=loggedUser.department%></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card mt-3">
                        <div class="card-body">
                            <h5 class="card-title text-center">Personal Informations</h5>
                            <hr />
                            <div class="row">
                                <div class="col-sm-6">
                                    <h6 class="mb-0">Full Name</h6>
                                </div>
                                <div class="col-sm-6 text-secondary" style="text-align:right"><%=loggedUser.firstName%> <%=loggedUser.lastName%></div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-sm-6">
                                    <h6 class="mb-0">Telephone</h6>
                                </div>
                                <div class="col-sm-6 text-secondary" style="text-align:right"><%=loggedUser.telephone%></div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-sm-6">
                                    <h6 class="mb-0">Email</h6>
                                </div>
                                <div class="col-sm-6 text-secondary" style="text-align:right"><%=loggedUser.username%></div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-sm-6"></div>
                                <div class="col-sm-6 text-secondary" style="text-align:right">
                                    <a class="btn btn-main btn-round-full make-appointment " target="__blank" style="color:white;"
                                        onclick="showPopUp2()">Edit</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-8">
                    <!-- <hr /> -->
                    <div class="row-md-8">
                        <div class="card mb-3">
                            <div class="card-body">
                                <h4 class="card-title text-center" id="appointmentList">Programari</h4>
                                <div class="row">
                                    <div class="col-4">
                                        <h4>Name</h4>
                                    </div>
                                    <div class="col-4">
                                        <h4>Time & Date</h4>
                                    </div>
                                    <div class="col-4">
                                        <h4>Doctor</h4>
                                    </div>
                                </div>
                                <% const sortedAppointments = appointments.sort((a, b) => {
                                    const dateA = new Date(a.date.split('/').reverse().join('/'));
                                    const dateB = new Date(b.date.split('/').reverse().join('/'));

                                    const timeA = parseInt(a.time);
                                    const timeB = parseInt(b.time);

                                    if(dateA < dateB) return -1;
                                    if(dateA > dateB) return 1;

                                    if(timeA < timeB) return -1;
                                    if(timeA > timeB) return 1;
                                    return 0;
                                });



                                sortedAppointments.forEach((appointment, index)  =>  { %>
                                    <hr />
                                    <div class="row">
                                        <div class="col-4">
                                            <h5 class="mb-0"><%=appointment.userId%></h5>
                                            <p class="">Tel: <%=appointment.telephone%></h6>
                                        </div>
                                        <div class="col-4">
                                            <p class="mb-0"><%= appointment.time%></p>
                                            <p class="mb-0"><%= appointment.date%></p>
                                        </div>
                                        <div class="col-4">
                                            <p class="mb-0"><%=appointment.doctorId%></p>
                                        </div>
                                    </div> 
                                    
                                    
                                <%});%>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <br /><br />
        </div>
    </div>
    
    <hr class="footer-space" />
    <%- include("partials/footer.ejs") -%>
    
</body>

</html>